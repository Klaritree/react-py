"use strict";(self.webpackChunkreact_py_docs=self.webpackChunkreact_py_docs||[]).push([[352],{7720:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>k,contentTitle:()=>y,default:()=>P,foliumCode:()=>N,frontMatter:()=>v,matplotlibCode:()=>M,metadata:()=>w,plotlyCode:()=>_,toc:()=>C});var o=n(7624),i=n(2172),s=n(1504),l=n(656),a=n(6528),r=n(4404),d=n(8764),c=n(4716),p=n(472),m=n(236),u=n(1203);const h={enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,highlightActiveLine:!1,showPrintMargin:!1},x=e=>{e.renderer.setScrollMargin(10,10,0,0),e.moveCursorTo(0,0)};function f(e){const{code:t,packages:i}=e,[f,b]=(0,s.useState)(t.trimEnd()),[g,j]=(0,s.useState)(!1);(0,s.useEffect)((()=>{b(t.trimEnd()),j(!1)}),[t]);const{colorMode:v}=(0,a.useColorMode)(),{runPython:y,stdout:w,stderr:k,isLoading:C,isRunning:M,interruptExecution:N}=(0,r.usePython)({packages:i});return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"relative mb-10 flex flex-col",children:[(0,o.jsx)(d.default,{items:[{label:"Run",icon:p.default,onClick:function(){y(f),j(!0)},disabled:C||M,hidden:M},{label:"Stop",icon:m.default,onClick:function(){N(),j(!1)},hidden:!M},{label:"Reset",icon:u.default,onClick:function(){j(!1),b(t.trimEnd())},disabled:M}]}),C&&(0,o.jsx)(c.default,{}),(0,o.jsx)(l.default,{fallback:(0,o.jsx)("div",{children:"Loading..."}),children:()=>{const e=n(3496).default;return n(6352),n(7504),n(7164),n(7424),(0,o.jsx)(e,{value:f,mode:"python",name:"CodeBlock",fontSize:"0.9rem",className:"min-h-[4rem] overflow-clip rounded shadow-md",theme:"dark"===v?"idle_fingers":"textmate",onChange:e=>b(e),width:"100%",maxLines:1/0,onLoad:x,editorProps:{$blockScrolling:!0},setOptions:h})}})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"Result"}),k?(0,o.jsx)("pre",{className:"mt-4 text-left",children:(0,o.jsx)("code",{className:"text-red-500",children:k})}):w&&w.startsWith("data:image/png;base64,")?(0,o.jsx)("img",{src:w}):(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"No image yet. Click run to see the result."})]})]})}const b={enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,highlightActiveLine:!1,showPrintMargin:!1},g=e=>{e.renderer.setScrollMargin(10,10,0,0),e.moveCursorTo(0,0)};function j(e){const{code:t,packages:i}=e,[h,x]=(0,s.useState)(t.trimEnd()),[f,j]=(0,s.useState)(!1);(0,s.useEffect)((()=>{x(t.trimEnd()),j(!1)}),[t]);const{colorMode:v}=(0,a.useColorMode)(),{runPython:y,stdout:w,stderr:k,isLoading:C,isRunning:M,interruptExecution:N}=(0,r.usePython)({packages:i});return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"relative mb-10 flex flex-col",children:[(0,o.jsx)(d.default,{items:[{label:"Run",icon:p.default,onClick:function(){y(h),j(!0)},disabled:C||M,hidden:M},{label:"Stop",icon:m.default,onClick:function(){N(),j(!1)},hidden:!M},{label:"Reset",icon:u.default,onClick:function(){j(!1),x(t.trimEnd())},disabled:M}]}),C&&(0,o.jsx)(c.default,{}),(0,o.jsx)(l.default,{fallback:(0,o.jsx)("div",{children:"Loading..."}),children:()=>{const e=n(3496).default;return n(6352),n(7504),n(7164),n(7424),(0,o.jsx)(e,{value:h,mode:"python",name:"CodeBlock",fontSize:"0.9rem",className:"min-h-[4rem] overflow-clip rounded shadow-md",theme:"dark"===v?"idle_fingers":"textmate",onChange:e=>x(e),width:"100%",maxLines:1/0,onLoad:g,editorProps:{$blockScrolling:!0},setOptions:b})}})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"Result"}),k?(0,o.jsx)("pre",{className:"mt-4 text-left",children:(0,o.jsx)("code",{className:"text-red-500",children:k})}):w?(0,o.jsx)("iframe",{srcDoc:w,className:"h-96 w-full"}):(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"No output yet. Click run to see the result."})]})]})}const v={sidebar_position:9},y="Data Visualisation",w={id:"examples/data-visualisation",title:"Data Visualisation",description:"Some data visualisation libraries can be used, but require some workarounds.",source:"@site/docs/examples/data-visualisation.mdx",sourceDirName:"examples",slug:"/examples/data-visualisation",permalink:"/react-py/docs/examples/data-visualisation",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"User Input",permalink:"/react-py/docs/examples/user-input"}},k={},C=[{value:"Matplotlib",id:"matplotlib",level:2},{value:"Patching <code>matplotlib.pyplot.show</code>",id:"patching-matplotlibpyplotshow",level:3},{value:"Folium",id:"folium",level:2},{value:"Plotly",id:"plotly",level:2}],M="import os\nimport base64\nfrom io import BytesIO\n\n# Set this _before_ importing matplotlib\nos.environ['MPLBACKEND'] = 'AGG'\n\nimport matplotlib.pyplot as plt\n\n# Patch\ndef ensure_matplotlib_patch():\n  _old_show = plt.show\n\n  def show():\n    buf = BytesIO()\n    plt.savefig(buf, format='png')\n    buf.seek(0)\n    # Encode to a base64 str\n    img = 'data:image/png;base64,' + \\\n    base64.b64encode(buf.read()).decode('utf-8')\n    # Write to stdout\n    print(img)\n    plt.clf()\n\n  plt.show = show\n\n\nensure_matplotlib_patch()\n\n# Plot\nfig, ax = plt.subplots()\nax.plot([1,3,2])\n\nplt.show()\n",N="import folium\n\n# Create a map centered at a specific location\nm = folium.Map(location=[37.7749, -122.4194], zoom_start=10)\n\n# Add a marker to the map\nfolium.Marker(\n    location=[37.7749, -122.4194],\n    popup=\"San Francisco, CA\",\n    icon=folium.Icon(color='blue')\n).add_to(m)\n\n# Get the HTML content of the map\nmap_html = m.get_root().render()\n\n# Print the HTML to stdout\nprint(map_html)\n",_="import plotly.express as px\n\n# Sample data\nx = [1, 2, 3, 4, 5]\ny = [2, 4, 1, 3, 7]\n\n# Create a line chart\nfig = px.line(x=x, y=y, title='Simple Line Chart')\n\n# Get the HTML content of the chart\nchart_html = fig.to_html()\n\n# Print the HTML to stdout\nprint(chart_html)\n";function L(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",...(0,i.useMDXComponents)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"data-visualisation",children:"Data Visualisation"}),"\n",(0,o.jsx)(t.p,{children:"Some data visualisation libraries can be used, but require some workarounds."}),"\n",(0,o.jsx)(t.h2,{id:"matplotlib",children:"Matplotlib"}),"\n",(0,o.jsxs)(t.p,{children:["By default, matplotlib relies on the import statement ",(0,o.jsx)(t.code,{children:"from js import document"}),", which does not work from within a web worker."]}),"\n",(0,o.jsxs)(t.p,{children:["One workaround is to patch the default behaviour of ",(0,o.jsx)(t.code,{children:"matplotlib.pyplot.show"}),"."]}),"\n",(0,o.jsxs)(t.h3,{id:"patching-matplotlibpyplotshow",children:["Patching ",(0,o.jsx)(t.code,{children:"matplotlib.pyplot.show"})]}),"\n",(0,o.jsxs)(t.p,{children:["The following patch sets matplotlib to use the ",(0,o.jsx)(t.code,{children:"AGG"})," renderer. ",(0,o.jsx)(t.a,{href:"https://github.com/pyodide/matplotlib-pyodide/issues/6#issuecomment-1242747625",children:"Source"}),"."]}),"\n",(0,o.jsx)(t.admonition,{type:"caution",children:(0,o.jsxs)(t.p,{children:["This workaround relies on the base64 string to be printed to ",(0,o.jsx)(t.code,{children:"stdout"}),"."]})}),"\n","\n",(0,o.jsx)(f,{code:M,packages:{official:["matplotlib"]}}),"\n",(0,o.jsxs)(t.p,{children:["You can find the source code for this example ",(0,o.jsx)(t.a,{href:"https://github.com/elilambnz/react-py/blob/main/website/src/components/ImageExample.tsx",children:"here"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"folium",children:"Folium"}),"\n",(0,o.jsx)(t.admonition,{type:"caution",children:(0,o.jsxs)(t.p,{children:["This workaround relies on the HTML output to be printed to ",(0,o.jsx)(t.code,{children:"stdout"}),"."]})}),"\n","\n",(0,o.jsx)(j,{code:N,packages:{micropip:["folium"]}}),"\n",(0,o.jsxs)(t.p,{children:["You can find the source code for this example ",(0,o.jsx)(t.a,{href:"https://github.com/elilambnz/react-py/blob/main/website/src/components/HTMLExample.tsx",children:"here"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"plotly",children:"Plotly"}),"\n",(0,o.jsx)(t.admonition,{type:"caution",children:(0,o.jsxs)(t.p,{children:["This workaround relies on the HTML output to be printed to ",(0,o.jsx)(t.code,{children:"stdout"}),"."]})}),"\n","\n",(0,o.jsx)(j,{code:_,packages:{official:["pandas"],micropip:["plotly"]}}),"\n",(0,o.jsxs)(t.p,{children:["You can find the source code for this example ",(0,o.jsx)(t.a,{href:"https://github.com/elilambnz/react-py/blob/main/website/src/components/HTMLExample.tsx",children:"here"}),"."]})]})}function P(e={}){const{wrapper:t}={...(0,i.useMDXComponents)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(L,{...e})}):L(e)}},8764:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});n(1504);var o=n(4971),i=n(7624);function s(e){const{items:t,isAwaitingInput:n}=e,s=t.filter((e=>!e.hidden));return(0,i.jsx)("div",{className:"pointer-events-none z-10 -mb-16 flex justify-end p-2",children:(0,i.jsxs)("div",{className:"pointer-events-auto space-x-2 rounded-md bg-white p-1 opacity-80 shadow-md hover:opacity-100",children:[n&&(0,i.jsxs)("div",{className:"inline-flex items-center rounded-md bg-sky-500 px-4 py-2 text-sm font-semibold leading-6 text-white shadow",children:[(0,i.jsxs)("svg",{className:"-ml-1 mr-3 h-5 w-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,i.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,i.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,i.jsx)("span",{children:"Awaiting input..."})]}),(0,i.jsx)("span",{className:"isolate inline-flex rounded-md",children:s.map(((e,t)=>(0,i.jsxs)("button",{type:"button",onClick:e.onClick,disabled:e.disabled,className:(0,o.default)("relative inline-flex items-center border border-none border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 focus:z-10 focus:outline-none focus:ring-0",e.disabled?"opacity-50 hover:cursor-not-allowed":"opacity-75 hover:cursor-pointer hover:bg-gray-50 hover:opacity-100",0===t&&"rounded-l-md",t===s.length-1&&"rounded-r-md"),children:[(0,i.jsx)(e.icon,{className:"-ml-1 mr-2 h-5 w-5 text-gray-400","aria-hidden":"true"}),e.label]},e.label)))})]})})}},4716:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});n(1504);var o=n(7624);function i(){return(0,o.jsx)("div",{className:"pointer-events-none absolute bottom-0 right-0 z-10 flex justify-end p-2",children:(0,o.jsxs)("div",{className:"inline-flex items-center rounded-md bg-sky-500 px-4 py-2 text-sm font-semibold leading-6 text-white shadow",children:[(0,o.jsxs)("svg",{className:"-ml-1 mr-3 h-5 w-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Setting up environment..."]})})}},2172:(e,t,n)=>{n.r(t),n.d(t,{MDXProvider:()=>a,useMDXComponents:()=>l});var o=n(1504);const i={},s=o.createContext(i);function l(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);